apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: teleport-cluster
  namespace: flux-system
spec:
  targetNamespace: teleport
  interval: 30m
  chart:
    spec:
      chart: teleport-cluster
      version: "18.2.10" # 2026-01-20, latest version
      sourceRef:
        kind: HelmRepository
        name: teleport
        namespace: flux-system
  dependsOn:
    - name: cert-manager
      namespace: flux-system
  values:
    clusterName: "teleport.avgmax.team"
    proxyListenerMode: multiplex
    auth:
      teleportConfig:
        # 추후 minio로 변경
        teleport:
          storage:
            type: dir
            path: /var/lib/teleport